CREATE DATABASE ORG
USE ORG
CREATE TABLE  WORKERS (
WORKERID INT NOT NULL PRIMARY KEY ,
FIRST_NAME CHAR(25),
LAST_NAME CHAR(25),
SALARY INT,
JOINING_DATE DATE,
DEPARTMENT CHAR(25)
)

SELECT FIRST_NAME,SALARY FROM  WORKERS WHERE SALARY>80000 AND DEPARTMENT='ADMIN' AND YEAR(JOINING_DATE	)='2020'
SELECT *FROM WORKERS WHERE SALARY>80000;
SELECT *FROM WORKERS WHERE DEPARTMENT='HR';
SELECT *FROM WORKERS WHERE SALARY BETWEEN 80000 AND 200000

SELECT WORKERID,FIRST_NAME,LAST_NAME,SALARY FROM WORKERS WHERE SALARY BETWEEN 200000 AND 500000

SELECT *FROM WORKERS WHERE DEPARTMENT IN('HR','ADMIN') AND SALARY BETWEEN 100000 AND 300000;
SELECT *FROM WORKERS WHERE NOT(SALARY>=300000)

SELECT *FROM WORKERS WHERE DEPARTMENT NOT IN('HR','ADMIN')





INSERT INTO WORKERS VALUES
(001,'MONIKA','ARORA',100000,'2020-02-14','HR'),
(002,'NIHARIKA','VERMA',80000,'2011-06-14','ADMIN'),
(003,'VISHAL','SINGHAL',300000,'2020-02-14','HR'),
(004,'AMITHABH','SINGH',500000,'2020-02-14','ADMIN'),
(005,'VIVEK','BHATI',500000,'2011-06-14','ADMIN'),
(006,'VIPUL','DIWAN',200000,'2011-06-14','ACCOUNT'),
(007,'SATISH','KUMAR',75000,'2020-01-14','ACCOUNT'),
(008,'GEETIKA','CHAUHAN',90000,'2011-04-14','ADMIN');
UPDATE WORKERS SET SALARY=40000 WHERE WORKERID=008
UPDATE WORKERS SET FIRST_NAME='ROHIT',LAST_NAME='SHETTY' WHERE SALARY= 200000
SELECT *FROM WORKERS
DELETE FROM WORKERS WHERE FIRST_NAME='MONIKA'
DELETE FROM WORKERS WHERE WORKERID=006
SELECT *FROM WORKERS ORDER BY SALARY 
SELECT *FROM WORKERS ORDER BY SALARY DESC

SELECT *FROM WORKERS ORDER BY SALARY ASC
SELECT DISTINCT(SALARY) FROM WORKERS
SELECT DISTINCT(DEPARTMENT) FROM WORKERS
SELECT *fROM WORKERS
SELECT *FROM WORKERS WHERE FIRST_NAME LIKE '%PU%'
SELECT *FROM WORKERS WHERE LAST_NAME LIKE 'BH%'
SELECT *FROM WORKERS WHERE DEPARTMENT LIKE '%CCOUNT'
SELECT *FROM WORKERS WHERE DEPARTMENT IN('HR','ADMIN') AND SALARY BETWEEN 200000 AND 500000 AND LAST_NAME LIKE 'SINGH%'

SELECT DEPARTMENT,COUNT(DEPARTMENT) FROM WORKERS GROUP BY DEPARTMENT
SELECT DEPARTMENT,COUNT(DEPARTMENT) AS NO_OF_DEPARTMENT,AVG(SALARY) AS AVG_SALARY,MIN(SALARY) AS MIN_SALALLRY,MAX(SALARY) AS MAX_SALARY FROM WORKERS GROUP BY DEPARTMENT 
SELECT SALARY,COUNT(SALARY) FROM WORKERS GROUP BY SALARY
SELECT DEPARTMENT,COUNT(DEPARTMENT),MIN(SALARY) FROM WORKERS GROUP BY DEPARTMENT HAVING MIN(SALARY)>75000 AND COUNT(DEPARTMENT)>=2



CREATE TABLE BONUSS(
WORKER_REF_ID INT,
BONUS_AMOUNT INT,
BONUS_DATE DATE,
FOREIGN KEY(WORKER_REF_ID) REFERENCES WORKERS(WORKERID) ON DELETE CASCADE

);
/*DELETE FROM BONUS WHERE WORKER_REF_ID=002;
SELECT *FROM BONUS*/

SELECT *FROM WORKERS
INSERT INTO BONUSS VALUES(001,5000,'2020-03-14'),(002,3000,'2021-06-11'),(003,4000,'2018-04-18'),(001,4500,'2019-09-28'),(002,3500,'2018-10-10')

/*SELECT W.WORKERID,W.DEPARTMENT,B.WORKER_REF_ID,B.BONUS_AMOUNT FROM WORKERS W INNER JOIN BONUSS B ON W.WORKERID=B.WORKER_REF_ID AND W.DEPARTMENT='ADMIN'*/
SELECT W.*,B.* FROM WORKERS W INNER JOIN BONUSS B ON W.WORKERID=B.WORKER_REF_ID
SELECT W.*,B.* FROM WORKERS W LEFT JOIN BONUSS B ON W.WORKERID=B.WORKER_REF_ID
SELECT W.*,B.* FROM WORKERS W RIGHT JOIN  BONUSS B ON W.WORKERID=B.WORKER_REF_ID
SELECT *FROM BONUSS
CREATE TABLE TITLES(
WORKER_REF_ID INT,
WORKER_TITLE CHAR(25),
AFFECTED_FROM DATE,
FOREIGN KEY(WORKER_REF_ID) REFERENCES WORKERS(WORKERID) ON DELETE CASCADE 
)



INSERT INTO TITLES VALUES(001,'MANAGER','2016-02-20'),(002,'EXECUTIVE','2016-06-11'),(008,'EXECUTIVE','2016-06-11'),(005,'MANAGER','2016-06-11'),(004,'ASST MANAGER','2016-06-11'),(007,'EXECUTIVE','2016-06-11'),(006,'LEAD','2016-06-11'),(003,'LEAD','2016-06-11')


CREATE TABLE ACCSS(
ID INT PRIMARY KEY,
NAME VARCHAR(20) UNIQUE,
BALANCE INT ,

CONSTRAINT ACC_BALANCE CHECK(BALANCE>1000)
);
DROP TABLE ACCS

insert into ACCSS VALUES(1,'AVINASH',45000)
select *from ACCSS

CREATE TABLE ACCAS(
ID INT PRIMARY KEY,
NAME VARCHAR(20) UNIQUE,
BALANCE INT NOT NULL DEFAULT 1200 


);

/*ADD NEW COLUMN*/
/*ALTER TABLE ACCAS ADD INTREST FLOAT NOT NULL DEFAULT 0
ALTER TABLE ACCAS ADD COMPOUNDINTREST FLOAT NOT NULL DEFAULT 0
SELECT *FROM ACCAS*/
/*MODIFY
ALTER TABLE ACCAS MODIFY INTREST INT NOT NULL DEFAULT 0;*/
ALTER TABLE ACCAS DROP COLUMN BALANCE
INSERT INTO ACCAS  VALUES(1,'AVINASH',0)
INSERT INTO ACCAS VALUES(2,'ABHIJEETH')
INSERT INTO ACCAS(ID,NAME) VALUES(3,'UNINI')

SELECT *FROM ACCAS
SELECT *FROM WORKERS
INSERT INTO WORKERS VALUES(1,'AMITABH','SINGH',70000,'2020-09-8','HR')
INSERT INTO WORKERS VALUES(6,'AMIT','SUMAN',80000,'2021-09-8','ADMIN')

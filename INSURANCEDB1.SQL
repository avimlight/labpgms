CREATE DATABASE INSUR12
USE INSUR12
CREATE TABLE PERSON(
DRIVERID VARCHAR(20),
NAME VARCHAR(20),
ADDRESS VARCHAR(20),
PRIMARY KEY(DRIVERID)
)
INSERT INTO PERSON VALUES('D1','JOHN SMITH','RAJA RAJESHWARI'),('D2','BOB JOHNSON','CHURCHROAD ADYAR'),('D3','RAMESH KP','PUTTUR SULYA'),('D4','SMITH JOHNSON','KERALA'),('D5','LUIS ANDRADE','UDUPI')
CREATE TABLE CAR(
REGNO VARCHAR(20),
MODEL VARCHAR(20),
YEAR INT,
PRIMARY KEY(REGNO)
)
INSERT INTO CAR VALUES('KA-12-1','WAGONR',1989),('KA-13-1','XUV',1990),('KA-14-1','BALENO',1996),('MH-12-1','SANTRO',1993),('TN-12-1','RAV4',1995),('KA-15-1','SUMO',1994),('KA-16-1','ALTO',1993),('KA-17-1','HYUNDAI',1992),('KA-18-1','BMW',1993),('KA-19-1','THAR',1995)
CREATE TABLE ACCIDENT(
REPORTNUMBER INT,
ACCDATE DATE,
LOCATION VARCHAR(20),
PRIMARY KEY(REPORTNUMBER)
)
INSERT INTO ACCIDENT VALUES(1,'1989-01-01','PADUPERRAR'),(2,'1989-02-01','PERMUDE'),(3,'1989-03-01','KINNIPADAVU'),(4,'1990-04-01','SOPHYANAGAR'),(5,'1992-05-01','DAMASKATE'),(6,'1989-01-01','PERRAR'),(7,'1989-08-01','BAJPE'),(8,'1989-08-01','KPNAGAR'),(9,'1989-04-01','KPNAGAR'),(10,'1989-05-01','KATESHWARA')
CREATE  TABLE OWNS(
DRIVERID VARCHAR(20),
REGNO VARCHAR(20),
PRIMARY KEY(DRIVERID,REGNO),
FOREIGN KEY(DRIVERID) REFERENCES PERSON(DRIVERID) ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY(REGNO) REFERENCES CAR(REGNO) ON DELETE CASCADE ON UPDATE CASCADE
)
INSERT INTO OWNS VALUES('D1','KA-12-1'),('D1','KA-13-1'),('D2','KA-14-1'),('D2','MH-12-1'),('D3','TN-12-1'),('D3','KA-15-1'),('D4','KA-16-1'),('D4','KA-17-1'),('D5','KA-18-1'),('D5','KA-19-1')
CREATE TABLE PARTICIPATED(
DRIVERID VARCHAR(20),
REGNO VARCHAR(20),
REPORTNUMBER INT,
DAMAGEAMOUNT INT,
PRIMARY KEY(DRIVERID,REGNO,REPORTNUMBER),
FOREIGN KEY(DRIVERID) REFERENCES PERSON(DRIVERID) ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY(REGNO) REFERENCES CAR(REGNO) ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY(REPORTNUMBER) REFERENCES ACCIDENT(REPORTNUMBER) ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY(DRIVERID,REGNO) REFERENCES OWNS(DRIVERID,REGNO)
)
INSERT INTO PARTICIPATED VALUES('D1','KA-12-1',1,3000),('D1','KA-13-1',2,6000),('D2','KA-14-1',3,7000),('D2','MH-12-1',4,8000),('D3','TN-12-1',5,9000),('D3','KA-15-1',6,7000),('D4','KA-16-1',7,12000),('D4','KA-17-1',8,30000),('D5','KA-18-1',9,4000),('D5','KA-19-1',10,2000)

SELECT COUNT(DISTINCT(P.DRIVERID)) AS 'NO OF PEOPLE' FROM ACCIDENT A,PARTICIPATED P  WHERE A.REPORTNUMBER=P.REPORTNUMBER AND YEAR(A.ACCDATE)='1989'
SELECT COUNT(P.REPORTNUMBER) AS 'NO OF ACCIDENT' FROM PARTICIPATED P,PERSON PN WHERE P.DRIVERID=PN.DRIVERID AND PN.NAME='JOHN SMITH'
SELECT *FROM  PARTICIPATED
UPDATE PARTICIPATED SET DAMAGEAMOUNT=30000 WHERE REPORTNUMBER=1 AND REGNO='KA-12-1'
SELECT *FROM  PARTICIPATED
SELECT *FROM PERSON
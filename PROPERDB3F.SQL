CREATE DATABASE WSES
USE WSES
CREATE TABLE STUDENT(
REGNO VARCHAR(20),
NAME VARCHAR(20),
MAJOR VARCHAR(20),
BDATE DATE,
PRIMARY KEY(REGNO)
)
CREATE TABLE COURSE(
COURSENO INT,
COURSENAME VARCHAR(20),
DEPT VARCHAR(20),
PRIMARY KEY(COURSENO)
)
CREATE TABLE ENROLL(
REGNO VARCHAR(20),
COURSENO INT,
SEM INT,
MARKS INT,
PRIMARY KEY(REGNO,COURSENO,SEM),
FOREIGN KEY(REGNO) REFERENCES STUDENT(REGNO) ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY(COURSENO) REFERENCES COURSE(COURSENO) ON DELETE CASCADE ON UPDATE CASCADE,
)
CREATE TABLE TEXTBOOK(
BOOKISBN INT,
BOOKTITLE VARCHAR(20),
PUBLISHER VARCHAR(20),
AUTHOR VARCHAR(20),
PRIMARY KEY(BOOKISBN)
)
CREATE TABLE BOOKADAPTION(
COURSENO INT,
SEM INT,
BOOKISBN INT,
PRIMARY KEY(COURSENO,SEM,BOOKISBN),
FOREIGN KEY(COURSENO) REFERENCES COURSE(COURSENO) ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY(BOOKISBN) REFERENCES TEXTBOOK(BOOKISBN) ON DELETE CASCADE ON UPDATE CASCADE
)

INSERT INTO STUDENT VALUES('S01','AVINASH','COMPUTERSCIENCE','2023-01-01'),('S02','ABHIJEETH','ELECTRICALENG','2023-02-01'),('S03','UNINI','COMPUTERSCIENCE','2023-03-01'),('S04','PUTHU','ELECTRICALENG','2023-04-01'),('S05','SHERATON','COMPUTERSCIENCE','2023-05-01')
INSERT INTO COURSE VALUES(101,'INTROTODBMS','CS'),(102,'INTROTOOS','CS'),(103,'INTROTOJAVA','CS'),(104,'INTROTOPYTHON','CS'),(105,'INTROTODSD','EE'),(106,'INTROGATES','EE')
INSERT INTO ENROLL VALUES('S01',101,1,90),('S01',102,1,91),('S02',101,1,92),('S02',102,1,93),('S03',101,1,94),('S03',102,1,95)
INSERT INTO TEXTBOOK VALUES(12,'DATABASE SCHEMA','MCGRAWHILL','ALAN THOMAS'),(23,'DATABASE CONCEPT','MCGRAWHILL','ALAN DOURE'),(34,'DATABASEDESIGN','MITPRESS','RANDASA'),(45,'INTROTOEE','MITPRESS','RAVINDRA')
INSERT INTO BOOKADAPTION VALUES(101,1,12),(101,1,23),(101,1,34),(102,1,12),(102,1,23),(103,1,34),(103,1,12),(104,1,23)

DELETE FROM STUDENT
DELETE FROM COURSE
DELETE FROM ENROLL
DELETE FROM TEXTBOOK
DELETE FROM BOOKADAPTION
SELECT DISTINCT(T.BOOKISBN),T.BOOKTITLE,C.COURSENO,C.COURSENAME FROM TEXTBOOK T,COURSE C, BOOKADAPTION B WHERE B.BOOKISBN=T.BOOKISBN AND C.COURSENO=B.COURSENO AND C.DEPT='CS' AND C.COURSENO IN (SELECT COURSENO FROM BOOKADAPTION GROUP BY COURSENO HAVING COUNT(DISTINCT(BOOKISBN))>2) ORDER BY T.BOOKTITLE

SELECT DISTINCT(C.DEPT) FROM COURSE C WHERE NOT EXISTS(
(SELECT BOOKISBN FROM BOOKADAPTION WHERE COURSENO IN(
SELECT COURSENO FROM COURSE WHERE DEPT=C.DEPT
))
EXCEPT
(SELECT BOOKISBN FROM TEXTBOOK WHERE PUBLISHER='MCGRAWHILL' )

)

SELECT DISTINCT(T.BOOKISBN),T.BOOKTITLE,C.DEPT FROM TEXTBOOK T,BOOKADAPTION B,COURSE C WHERE T.BOOKISBN=B.BOOKISBN AND C.COURSENO=B.COURSENO AND C.DEPT IN(SELECT C.DEPT FROM COURSE C,ENROLL E WHERE C.COURSENO=E.COURSENO GROUP BY C.DEPT HAVING COUNT(*)>=ALL(SELECT COUNT(*) FROM COURSE C,ENROLL E WHERE C.COURSENO=E.COURSENO GROUP BY C.DEPT)) 